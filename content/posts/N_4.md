---
title: 'Damped Pendulum: Equilibrium Points and Stability Analysis'
date: 2025-08-14T00:00:00.000Z
author: souhail chahmout
tags:
  - Nonlinear_Dynamics
  - Phase_Plane_Analysis
  - Damped_Pendulum
  - Stability_Analysis
  - Determinant_Trace_Plane
math: katex
---

## **Unlocking the Dynamics of Nonlinear Systems: A Guide to Phase-Plane Analysis**

The world is full of systems that don't behave in a simple, predictable way. These are known as nonlinear systems, and understanding them is crucial in fields ranging from physics and engineering to biology and economics. Unlike linear systems, where the output is directly proportional to the input, **nonlinear systems** are governed by equations that contain terms that are not linear, such as quadratic terms ($x^2$), cubic terms ($x^3$), or trigonometric functions ($\sin x$). This nonlinearity leads to complex behaviors that cannot be fully described by simple superposition.

For example, a linear system with two stable states would always return to its equilibrium after a small disturbance. However, a nonlinear system can exhibit multiple stable and unstable states, chaotic behavior, or limit cycles where the system oscillates endlessly. This is why we need more sophisticated analytical tools.

-----

### **Visualizing System Behavior with Phase-Plane Analysis**

When dealing with a second-order nonlinear system, one of the most powerful analytical methods is **phase-plane analysis**. It's a graphical technique that allows us to visualize the system's behavior without directly solving the complex differential equations. We transform the second-order differential equation into a system of two first-order equations by defining two state variables, such as position and velocity.

By plotting these two variables against each other, we create a **phase plane**. The path a system takes over time, starting from a specific initial condition, is called a **trajectory** or **orbit**. The collection of all possible trajectories for all possible initial conditions forms the **phase portrait** of the system. This portrait reveals key dynamic features, such as stability, equilibrium points, and periodic oscillations.

-----

### **The Damped Pendulum: A Classic Example**

A simple pendulum is a classic example of a nonlinear system. Its motion is described by the second-order differential equation:

$$
L\,\ddot{\theta} + b\,\dot{\theta} + g\,\sin\theta = 0
$$

To analyze this system using the phase-plane method, we rewrite it as two first-order differential equations. Let the angular position be $x = \theta$ and the angular velocity be $y = \dot{\theta}$. Then:

1. $\frac{dx}{dt} = y$
2. $\frac{dy}{dt} = -\frac{b}{L}y - \frac{g}{L}\sin x$

For simplicity, we define $\omega^2 = \frac{g}{L}$ and assume the damping coefficient is normalized. The equations become:

1. $x' = y$
2. $y' = -b\,y - \omega^2 \sin x$

---

### **Equilibrium Points and Stability**

**Equilibrium solutions** (or **fixed points**) are points in the phase plane where the system is at rest. They are found by setting the time derivatives of both state variables to zero:

$$
x' = y = 0
$$

$$
y' = -b\,y - \omega^2 \sin x = 0
$$

From these equations, we get $y = 0$ and $\sin x = 0$.
The solutions for $x$ are $x = n\pi$, where $n$ is any integer.
Thus, the pendulum has infinitely many fixed points at:

$$
(x, y) = (n\pi, 0)
$$

---

To determine their stability, we consider a small **perturbation** $\mathbf{x}=\mathbf{x}^{*}+\xi$, a tiny deviation from the equilibrium $\xi$, and analyze how the system responds.

* A **stable** fixed point returns to equilibrium after a small disturbance.
* An **unstable** fixed point moves away from equilibrium after a disturbance.

The stability is determined by the **eigenvalues** $(\lambda)$ of the **Jacobian matrix** $J$ evaluated at the fixed point.

The Jacobian for the system is:

$$
J =
\begin{bmatrix}
0 & 1 \\\
-\omega^{2} \cos x & -b
\end{bmatrix} 
$$

From this matrix:

$$
\text{tr}(J) = 0 + (-b) = -b
$$

$$
\det(J) = (0)(-b) - (1)(-\omega^2 \cos x) = \omega^2 \cos x
$$

The eigenvalues are the solutions of the characteristic equation:

$$
\lambda^2 - \text{tr}(J)\lambda + \det(J) = 0
$$

The solution of this equation is found using the quadratic formula,

$$
\lambda=\dfrac{1}{2}\left[-\operatorname{tr}(J) \pm \sqrt{\operatorname{tr}^{2}(J)-4 \operatorname{det}(J)}\right]\nonumber
$$



---

**Classification of fixed points:**

* **Saddle Point**: $\det(J) < 0$
  Eigenvalues are real with opposite signs → always unstable.

* **Node**: $\det(J) > 0$ and $(\text{tr}(J))^2 - 4\det(J) > 0$
  Eigenvalues are real with the same sign. Stable if $\text{tr}(J) < 0$, unstable if $\text{tr}(J) > 0$.

* **Focus (Spiral)**: $\det(J) > 0$ and $(\text{tr}(J))^2 - 4\det(J) < 0$
  Eigenvalues are complex conjugates. Stable if $\text{tr}(J) < 0$, unstable if $\text{tr}(J) > 0$.

* **Center**: $\det(J) > 0$ and $\text{tr}(J) = 0$
  Eigenvalues are purely imaginary → neutrally stable (only occurs for undamped systems).

---

This stability classification can be visually represented in the **determinant–trace plane** $\operatorname{tr}^{2}(J)=4 \operatorname{det}(J) \nonumber$, where each region corresponds to a different type of fixed point.

![product-jpeg-500x500](/images/N_4_1.png "Title here")

-----

As we have found before, there is an infinite set of equilibrium points.

$$
(x, y) = (n\pi, 0), \quad n = 0, \pm 1, \pm 2, \dots
$$

The Jacobian matrix is:

$$
J(x, y) =
\begin{bmatrix}
0 & 1 \\\
-\omega^2 \cos x & -b
\end{bmatrix}
$$

Evaluating at $(n\pi, 0)$:

$$
J(n\pi, 0) =
\begin{bmatrix}
0 & 1 \\\
(-1)^{n+1}\omega^2 & -b
\end{bmatrix}
$$

The characteristic equation is:

$$
\lambda^2 + b\,\lambda + (-1)^{n+1} \omega^2 = 0
$$

---

#### **Case 1: $n$ even**

Here $(-1)^{n+1} = -1$, so:

$$
\lambda^2 + b\,\lambda + \omega^2 = 0
$$

The eigenvalues are:

$$
\lambda = \frac{-b \pm \sqrt{b^2 - 4\omega^2}}{2}
$$

* If $b^2 < 4\omega^2$: complex conjugates with negative real part → **stable focus**.
* If $b = 0$: purely imaginary eigenvalues → **center** (undamped).

![product-jpeg-500x500](/images/N_4_4.png "Title here")

#### **Case 2: $n$ odd**

Here $(-1)^{n+1} = +1$, so:

$$
\lambda^2 + b \lambda - \omega^2 = 0
$$

The eigenvalues are:

$$
\lambda = \frac{-b \pm \sqrt{b^2 + 4\omega^2}}{2}
$$

One eigenvalue is positive, the other negative → **saddle point** (always unstable).
If $b = 0$, the eigenvalues reduce to $\pm\omega$.

---

This means:

* Even $n$ → **stable foci** (with damping) or **centers** (without damping).
* Odd $n$ → **unstable saddles**.

phase plane for the undamped nonlinear pendulum:

![product-jpeg-500x500](/images/N_4_2.png "Title here")

phase plane for the damped nonlinear pendulum:

![product-jpeg-500x500](/images/N_4_3.png "Title here")

These classifications can be represented in the determinant–trace plane, where the fixed points fall into the corresponding regions depending on $\det(J) = \omega^2 \cos(n\pi)$ and $\text{tr}(J) = -b$.


-----

### MATLAB Implementation and Numerical Verification

To verify our analytical findings and visualize the phase portrait behavior, we implement the damped pendulum system in MATLAB. This numerical approach allows us to confirm the theoretical predictions about equilibrium point stability and trajectory behavior.

#### System Implementation

The nonlinear damped pendulum system is implemented using the state-space representation:
$$
\dot{\mathbf{x}} = \begin{bmatrix} \dot{\theta}  \\\ \ddot{\theta} \end{bmatrix} = \begin{bmatrix} \theta_d  \\\ -\omega^2 \sin \theta - b \theta_d \end{bmatrix}
$$

where $\omega^2 = g/L$ and the state vector is $\mathbf{x} = [\theta, \theta_d]^T$.

```matlab
%% System parameters matching theoretical analysis
g = 9.81; % gravity (m/s^2)
L = 1.0; % pendulum length (m)
b = 0.5; % damping coefficient (1/s)
omega_squared = g/L; % natural frequency squared

%% Pendulum ODE system
% State: y(1) = theta, y(2) = theta_dot
pendulum = @(t,y) [y(2); -omega_squared*sin(y(1)) - b*y(2)];

%% Vector field computation
% For phase plane: U = dx/dt, V = dy/dt
U = THDOT; % d(theta)/dt = theta_dot
V = -omega_squared*sin(TH) - b*THDOT; % d(theta_dot)/dt from our ODE
```

#### Equilibrium Point Verification

Our MATLAB code systematically identifies and classifies all equilibrium points according to our theoretical analysis:

```matlab
%% Theoretical equilibrium points: (n*pi, 0)
stable_points = [0, -2*pi, 2*pi, -4*pi, 4*pi]; % n even
unstable_points = [-3*pi, -pi, pi, 3*pi]; % n odd

% Verify stability through eigenvalue analysis
omega_n = sqrt(omega_squared);
zeta = b/(2*omega_n); % damping ratio

fprintf('Damping ratio ζ = %.3f\n', zeta);
if zeta < 1
    fprintf('b² < 4ω²: Stable foci (underdamped oscillation)\n');
else
    fprintf('b² ≥ 4ω²: Stable nodes (overdamped)\n');
end
```

#### Trajectory Analysis and Phase Portrait Generation

The implementation generates multiple trajectories from strategically chosen initial conditions to demonstrate different behavioral regimes:

```matlab
%% Initial conditions for comprehensive analysis
initial_conditions = [
    0.5, 0;     % Small oscillation → stable focus behavior
    1.5, 0;     % Larger oscillation → spiral to origin
    3.0, 0;     % Near unstable point → approach to stable equilibrium
    pi, 0.1;    % Near saddle point → separatrix behavior
    pi, -0.1;   % Opposite side of saddle → different separatrix
    1, 2;       % High energy → large phase space exploration
    1, -2;      % Negative velocity → clockwise motion
];

%% Solve and visualize trajectories
for i = 1:size(initial_conditions,1)
    y0 = initial_conditions(i,:)';
    [ts, ys] = ode45(pendulum, [0, 15], y0);
    plot(ys(:,1), ys(:,2), 'LineWidth', 1.8);
end
```

#### Vector Field Visualization

The normalized vector field clearly shows the flow directions predicted by our linearization analysis:

```matlab
%% Normalized vector field for clear flow visualization
len = sqrt(U.^2 + V.^2);
len(len==0) = 1; % avoid singularities
U_norm = U./len;
V_norm = V./len;
quiver(TH, THDOT, U_norm, V_norm, 0.6, 'r', 'LineWidth', 0.8);
```

#### Numerical Results and Theoretical Validation

The MATLAB simulation confirms our analytical predictions:

**For $n$ even (stable equilibria at $\theta = 0, \pm 2\pi, \pm 4\pi, ...$):**
- Trajectories spiral inward to these points
- Damping ratio $\zeta = \frac{b}{2\omega} = \frac{0.5}{2\sqrt{9.81}} \approx 0.080 < 1$
- Confirms underdamped behavior with stable foci

**For $n$ odd (saddle points at $\theta = \pm\pi, \pm 3\pi, ...$):**
- Trajectories diverge from these points along unstable manifolds
- Eigenvalues: $\lambda = \frac{-b \pm \sqrt{b^2 + 4\omega^2}}{2} = \frac{-0.5 \pm \sqrt{0.25 + 39.24}}{2}$
- One positive, one negative eigenvalue confirms saddle point behavior

#### Complete MATLAB Implementation

```matlab
%% Enhanced Phase Portrait Analysis
figure('Position', [100, 100, 1200, 900]);
hold on;

%% System parameters and theoretical calculations
g = 9.81; L = 1.0; b = 0.5;
omega = sqrt(g/L); zeta = b/(2*omega);

%% Vector field grid
theta_range = -pi:pi/6:4*pi;
theta_dot_range = -6:0.5:6;
[TH, THDOT] = meshgrid(theta_range, theta_dot_range);

%% Flow field computation
U = THDOT;
V = -(g/L)*sin(TH) - b*THDOT;
len = sqrt(U.^2 + V.^2); len(len==0) = 1;
quiver(TH, THDOT, U./len, V./len, 0.6, 'r', 'LineWidth', 0.8);

%% Multiple trajectory integration
initial_conditions = [0.5,0; 1.5,0; 3.0,0; pi,0.1; pi,-0.1; 1,2; 1,-2];
colors = lines(size(initial_conditions,1));

for i = 1:size(initial_conditions,1)
    [ts, ys] = ode45(@(t,y) [y(2); -(g/L)*sin(y(1)) - b*y(2)], ...
                     [0, 15], initial_conditions(i,:)');
    plot(ys(:,1), ys(:,2), 'Color', colors(i,:), 'LineWidth', 1.8);
    plot(initial_conditions(i,1), initial_conditions(i,2), 'o', ...
         'MarkerSize', 8, 'MarkerFaceColor', 'green', 'MarkerEdgeColor', 'black');
end

%% Mark equilibrium points according to theory
stable_eq = [0, -2*pi, 2*pi]; % n even → stable foci
unstable_eq = [-pi, pi]; % n odd → saddle points

plot(stable_eq, zeros(size(stable_eq)), 'o', 'MarkerSize', 12, ...
     'MarkerFaceColor', 'blue', 'MarkerEdgeColor', 'black', 'LineWidth', 2);
plot(unstable_eq, zeros(size(unstable_eq)), 's', 'MarkerSize', 12, ...
     'MarkerFaceColor', 'red', 'MarkerEdgeColor', 'black', 'LineWidth', 2);

%% Formatting and theoretical annotation
xlabel('Angular Position θ (radians)', 'FontSize', 14, 'FontWeight', 'bold');
ylabel('Angular Velocity dθ/dt (rad/s)', 'FontSize', 14, 'FontWeight', 'bold');
title('Damped Nonlinear Pendulum: Numerical Verification of Analytical Results', ...
      'FontSize', 16, 'FontWeight', 'bold');

xlim([-pi, 4*pi]); ylim([-6, 6]);
set(gca, 'XTick', [-pi:pi:4*pi], 'XTickLabel', {'-π','0','π','2π','3π','4π'});
grid on; set(gca, 'GridAlpha', 0.3, 'FontSize', 12);

%% Theoretical validation box
dim = [0.02 0.68 0.35 0.28];
str = {sprintf('**Theoretical Validation:**'), ...
       sprintf('ω₀ = %.3f rad/s, ζ = %.3f', omega, zeta), ...
       sprintf('Condition: b² = %.3f < 4ω² = %.3f ✓', b^2, 4*omega^2), ...
       sprintf(''), ...
       sprintf('**Equilibrium Classification:**'), ...
       sprintf('• n even (θ = 0, ±2π, ...): Stable foci'), ...
       sprintf('  λ = %.3f ± %.3fi', -b/2, omega*sqrt(1-zeta^2)), ...
       sprintf('• n odd (θ = ±π, ±3π, ...): Saddle points'), ...
       sprintf('  λ = %.3f, %.3f', (-b+sqrt(b^2+4*omega^2))/2, (-b-sqrt(b^2+4*omega^2))/2)};

annotation('textbox', dim, 'String', str, 'FitBoxToText', 'on', ...
           'BackgroundColor', 'yellow', 'FaceAlpha', 0.95, 'FontSize', 10, ...
           'EdgeColor', 'black', 'LineWidth', 1);

legend({'Vector Field', 'Trajectories', 'Initial Conditions', ...
        'Stable Foci (n even)', 'Saddle Points (n odd)'}, ...
       'Location', 'northeast', 'FontSize', 11);

hold off;
```

This numerical implementation provides quantitative validation of our theoretical analysis, demonstrating the correspondence between eigenvalue calculations and actual system behavior in the phase plane. The visualization clearly shows the predicted stable foci and unstable saddle points, confirming our linearization-based classification.

![product-jpeg-500x500](/images/N_4_5.png "Title here")

--------